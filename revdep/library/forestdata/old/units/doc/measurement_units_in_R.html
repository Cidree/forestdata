<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Edzer Pebesma, Thomas Mailund, and James Hiebert" />


<title>Measurement units in R</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Measurement units in R</h1>
<h4 class="author">Edzer Pebesma, Thomas Mailund, and James Hiebert</h4>


<div id="TOC">
<ul>
<li><a href="#abstract">Abstract</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#si">SI</a></li>
<li><a href="#related-work-in-r">Related work in R</a></li>
<li><a href="#unidatas-udunits-library">UNIDATA’s udunits library</a></li>
<li><a href="#udunits-versus-the-unified-code-for-units-of-measure-ucum">Udunits versus the Unified Code for Units of Measure (UCUM)</a></li>
<li><a href="#handling-data-with-units-in-r-the-units-package">Handling data with units in R: the units package</a></li>
<li><a href="#discussion-and-conclusions">Discussion and conclusions</a></li>
<li><a href="#acknowledgements">Acknowledgements</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>This vignette is identical to <span class="citation">Pebesma, Mailund, and Hiebert (<a href="#ref-rj" role="doc-biblioref">2016</a>)</span>, except for two changes:</p>
<ul>
<li>it has been synchronized with updates to the <a href="https://cran.r-project.org/package=units">units</a> package</li>
<li>it has been converted to R-markdown</li>
</ul>
<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>We briefly review SI units, and discuss R packages that deal with measurement units, their compatibility and conversion. Built upon the UNIDATA udunits library, we introduce the package <a href="https://cran.r-project.org/package=units">units</a> that provides a class for maintaining unit metadata. When used in expression, it automatically converts units, and simplifies units of results when possible; in case of incompatible units, errors are raised. The class flexibly allows expansion beyond predefined units. Using <a href="https://cran.r-project.org/package=units">units</a> may eliminate a whole class of potential scientific programming mistakes. We discuss the potential and limitations of computing with explicit units.</p>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Two quotes from <span class="citation">Cobb and Moore (<a href="#ref-cobb" role="doc-biblioref">1997</a>)</span> – <em>Data are not just numbers, they are numbers with a context</em> and <em>in data analysis, context provides meaning</em> – illustrate that for a data analysis to be meaningful, knowledge of the data’s context is needed. Pragmatic aspects of this context include who collected or generated the data, how this was done, and for which purpose <span class="citation">(Scheider et al. <a href="#ref-scheider" role="doc-biblioref">2016</a>)</span>; semantic aspects concern what the data represents: which aspect of the world do the data refer to, when and where were they measured, and what a value of <code>1</code> means.</p>
<p>R does allow for keeping some context with data, for instance</p>
<ul>
<li><code>data.frame</code> columns must have and <code>list</code> elements may have names that can be used to describe context, using freetext</li>
<li><code>matrix</code> or <code>array</code> objects may have <code>dimnames</code></li>
<li>for variables of class <code>factor</code> or <code>ordered</code>, <code>levels</code> may indicate, using freetext, the categories of nominal or ordinal variables</li>
<li><code>POSIXt</code> and <code>Date</code> objects specify how numbers should be interpreted as time or date, with fixed units (second and day, respectively) and origin (Jan 1, 1970, 00:00 UTC)</li>
<li><code>difftime</code> objects specify how time duration can be represented by numbers, with flexible units (secs, mins, hours, days, weeks); <a href="https://cran.r-project.org/package=lubridate">lubridate</a> <span class="citation">(Grolemund and Wickham <a href="#ref-lubridate" role="doc-biblioref">2011</a>)</span> extends some of this functionality.</li>
</ul>
<p>Furthermore, if spatial objects as defined in package <a href="https://cran.r-project.org/package=sp">sp</a> <span class="citation">(Pebesma and Bivand <a href="#ref-sp" role="doc-biblioref">2005</a>)</span> have a proper coordinate reference system set, they can be transformed to other datums, or converted to various flat (projected) representations of the Earth <span class="citation">(Iliffe and Lott <a href="#ref-iliffe" role="doc-biblioref">2008</a>)</span>.</p>
<p>In many cases however, R drops contextual information. As an example, we look at annual global land-ocean temperature index (from <code>http://climate.nasa.gov/vital-signs/global-temperature/</code>) since 1960:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>temp_data =<span class="st"> </span><span class="kw">subset</span>(<span class="kw">read.table</span>(<span class="st">&quot;647_Global_Temperature_Data_File.txt&quot;</span>, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>    <span class="dt">header=</span><span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], Year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1960</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>temp_data<span class="op">$</span>date =<span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">paste0</span>(temp_data<span class="op">$</span>Year, <span class="st">&quot;-01-01&quot;</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>temp_data<span class="op">$</span>time =<span class="st"> </span><span class="kw">as.POSIXct</span>(temp_data<span class="op">$</span>date)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="kw">Sys.setenv</span>(<span class="dt">TZ=</span><span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="kw">head</span>(temp_data, <span class="dv">3</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="co">##    Year Annual_Mean       date       time</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="co">## 81 1960       -0.03 1960-01-01 1960-01-01</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="co">## 82 1961        0.05 1961-01-01 1961-01-01</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="co">## 83 1962        0.02 1962-01-01 1962-01-01</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a>year_duration =<span class="st"> </span><span class="kw">diff</span>(temp_data<span class="op">$</span>date)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="kw">mean</span>(year_duration)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a><span class="co">## Time difference of 365.2545 days</span></span></code></pre></div>
<p>Here, the time difference units are reported for the <code>difftime</code> object <code>year_duration</code>, but if we would use it in a linear algebra operation</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>year_duration <span class="op">%*%</span><span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(year_duration)) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(year_duration)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="co">##          [,1]</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="co">## [1,] 365.2545</span></span></code></pre></div>
<p>the unit is dropped. Similarly, for linear regression coefficients we see</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">coef</span>(<span class="kw">lm</span>(Annual_Mean <span class="op">~</span><span class="st"> </span>date, temp_data))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co">##  (Intercept)         date </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="co">## 1.833671e-02 4.364763e-05</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="kw">coef</span>(<span class="kw">lm</span>(Annual_Mean <span class="op">~</span><span class="st"> </span>time, temp_data))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="co">##  (Intercept)         time </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="co">## 1.833671e-02 5.051809e-10</span></span></code></pre></div>
<p>where the unit of change is in degrees Celsius but either <em>per day</em> (<code>date</code>) or <em>per second</em> (<code>time</code>). For purely mathematical manipulations, R often strips context from numbers when it is carried in attributes, the linear algebra routines being a prime example.</p>
<p>Most variables are somehow attributed with information about their <em>units</em>, which specify what the value <code>1</code> of this variable represents. This may be counts of something, e.g. <code>1 apple</code>, but it may also refer to some <em>physical unit</em>, such as distance in meter. This article discusses how strong unit support can be introduced in R.</p>
</div>
<div id="si" class="section level2">
<h2>SI</h2>
<p>The <a href="https://www.bipm.org/">BIPM</a> (Bureau International des Poids et Mesures) is “<em>the intergovernmental organization through which Member States act together on matters related to measurement science and measurement standards. Its recommended practical system of units of measurement is the International System of Units (Système International d’Unités, with the international abbreviation SI)</em> (<a href="https://www.bipm.org/en/measurement-units/" class="uri">https://www.bipm.org/en/measurement-units/</a>)”.</p>
<p><span class="citation">International Bureau of Weights and Measures, Taylor, and Thompson (<a href="#ref-si" role="doc-biblioref">2001</a>)</span> describe the SI units, where, briefly, <em>SI units</em></p>
<ul>
<li>consist of seven base units (length, mass, time &amp; duration, electric current, thermodynamic temperature, amount of substance, and luminous intensity), each with a name and abbreviation (see table below)</li>
<li>consist of <em>derived units</em> that are formed by products of powers of base units, such as m/s<span class="math inline">\(^2\)</span>, many of which have special names and symbols (e.g. angle: 1 rad = 1 m/m; force: 1 N = 1 m kg s<span class="math inline">\(^{-2}\)</span>)</li>
<li>consist of <em>coherent derived units</em> when derived units include no numerical factors other than one (with the exception of <code>kg</code>; as a base unit, kg can be part of coherent derived units); an example of a coherent derived unit is 1 watt = 1 joule per 1 second,</li>
<li>may contain SI prefixes (k = kilo for <span class="math inline">\(10^3\)</span>, m = milli for <span class="math inline">\(10^{-3}\)</span>, etc.)</li>
<li>contain special quantities where units disappear (e.g., m/m) or have the nature of a count, in which cases the unit is 1.</li>
</ul>
<p>base quantities, SI units and their symbols (from <span class="citation">International Bureau of Weights and Measures, Taylor, and Thompson (<a href="#ref-si" role="doc-biblioref">2001</a>)</span>, p. 23):</p>
<table>
<thead>
<tr class="header">
<th>Base quantity</th>
<th></th>
<th>SI base unit</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Name</td>
<td>Symbol</td>
<td>Name</td>
<td>Symbol</td>
</tr>
<tr class="even">
<td>length</td>
<td><span class="math inline">\(l,x,r,\)</span> etc.</td>
<td>meter</td>
<td>m</td>
</tr>
<tr class="odd">
<td>mass</td>
<td><span class="math inline">\(m\)</span></td>
<td>kilogram</td>
<td>kg</td>
</tr>
<tr class="even">
<td>time, duration</td>
<td><span class="math inline">\(t\)</span></td>
<td>second</td>
<td>s</td>
</tr>
<tr class="odd">
<td>electric current</td>
<td><span class="math inline">\(I, i\)</span></td>
<td>ampere</td>
<td>A</td>
</tr>
<tr class="even">
<td>thermodynamic temperature</td>
<td><span class="math inline">\(T\)</span></td>
<td>kelvin</td>
<td>K</td>
</tr>
<tr class="odd">
<td>amount of substance</td>
<td><span class="math inline">\(n\)</span></td>
<td>mole</td>
<td>mol</td>
</tr>
<tr class="even">
<td>luminous intensity</td>
<td><span class="math inline">\(I_v\)</span></td>
<td>candela</td>
<td>cd</td>
</tr>
</tbody>
</table>
</div>
<div id="related-work-in-r" class="section level2">
<h2>Related work in R</h2>
<p>Several R packages provide unit conversions. For instance, <a href="https://cran.r-project.org/package=measurements">measurements</a> <span class="citation">(Birk <a href="#ref-measurements" role="doc-biblioref">2016</a>)</span> provides a collection of tools to make working with physical measurements easier. It converts between metric and imperial units, or calculates a dimension’s unknown value from other dimensions’ measurements. It does this by the <code>conv_unit</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">library</span>(measurements)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">conv_unit</span>(<span class="fl">2.54</span>, <span class="st">&quot;cm&quot;</span>, <span class="st">&quot;inch&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="co">## [1] 1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="kw">conv_unit</span>(<span class="kw">c</span>(<span class="st">&quot;101 44.32&quot;</span>,<span class="st">&quot;3 19.453&quot;</span>), <span class="st">&quot;deg_dec_min&quot;</span>, <span class="st">&quot;deg_min_sec&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="co">## [1] &quot;101 44 19.2000000000116&quot; &quot;3 19 27.1800000000003&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="kw">conv_unit</span>(<span class="dv">10</span>, <span class="st">&quot;cm_per_sec&quot;</span>, <span class="st">&quot;km_per_day&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="co">## [1] 8.64</span></span></code></pre></div>
<p>but uses for instance <code>kph</code> instead of <code>km_per_hour</code>, and then <code>m3_per_hr</code> for flow – unit names seem to come from convention rather than systematic composition. Object <code>conv_unit_options</code> contains all 173 supported units, categorized by the physical dimension they describe:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">names</span>(conv_unit_options)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="co">##  [1] &quot;acceleration&quot; &quot;angle&quot;        &quot;area&quot;         &quot;coordinate&quot;   &quot;count&quot;       </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="co">##  [6] &quot;duration&quot;     &quot;energy&quot;       &quot;file_size&quot;    &quot;flow&quot;         &quot;length&quot;      </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co">## [11] &quot;mass&quot;         &quot;power&quot;        &quot;pressure&quot;     &quot;speed&quot;        &quot;temperature&quot; </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="co">## [16] &quot;torque&quot;       &quot;volume&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>conv_unit_options<span class="op">$</span>volume</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="co">##  [1] &quot;ul&quot;        &quot;uL&quot;        &quot;ml&quot;        &quot;mL&quot;        &quot;dl&quot;        &quot;dL&quot;       </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="co">##  [7] &quot;l&quot;         &quot;L&quot;         &quot;cm3&quot;       &quot;dm3&quot;       &quot;m3&quot;        &quot;km3&quot;      </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="co">## [13] &quot;us_tsp&quot;    &quot;us_tbsp&quot;   &quot;us_oz&quot;     &quot;us_cup&quot;    &quot;us_pint&quot;   &quot;us_quart&quot; </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="co">## [19] &quot;us_gal&quot;    &quot;inch3&quot;     &quot;in3&quot;       &quot;ft3&quot;       &quot;mi3&quot;       &quot;imp_tsp&quot;  </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a><span class="co">## [25] &quot;imp_tbsp&quot;  &quot;imp_oz&quot;    &quot;imp_cup&quot;   &quot;imp_pint&quot;  &quot;imp_quart&quot; &quot;imp_gal&quot;</span></span></code></pre></div>
<p>Function <code>conv_dim</code> allows for the conversion of units in products or ratios, e.g.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">conv_dim</span>(<span class="dt">x =</span> <span class="dv">100</span>, <span class="dt">x_unit =</span> <span class="st">&quot;m&quot;</span>, <span class="dt">trans =</span> <span class="dv">3</span>, <span class="dt">trans_unit =</span> <span class="st">&quot;ft_per_sec&quot;</span>, <span class="dt">y_unit =</span> <span class="st">&quot;min&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="co">## [1] 1.822689</span></span></code></pre></div>
<p>computes how many minutes it takes to travel 100 meters at 3 feet per second.</p>
<p>Package <a href="https://cran.r-project.org/package=NISTunits">NISTunits</a> <span class="citation">(Gama <a href="#ref-NISTunits" role="doc-biblioref">2014</a>)</span> provides fundamental physical constants (Quantity, Value, Uncertainty, Unit) for SI and non-SI units, plus unit conversions, based on the data from NIST (National Institute of Standards and Technology). The package provides a single function for every unit conversion; all but 5 from its 896 functions are of the form <code>NISTxxxTOyyy</code> where <code>xxx</code> and <code>yyy</code> refer to two different units. For instance, converting from W m<span class="math inline">\(^{-2}\)</span> to W inch<span class="math inline">\(^{-2}\)</span> is done by</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">library</span>(NISTunits)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="kw">NISTwattPerSqrMeterTOwattPerSqrInch</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="co">## [1] 0.00064516 0.00129032 0.00193548 0.00258064 0.00322580</span></span></code></pre></div>
<p>Both <a href="https://cran.r-project.org/package=measurements">measurements</a> and <a href="https://cran.r-project.org/package=NISTunits">NISTunits</a> are written entirely in R.</p>
</div>
<div id="unidatas-udunits-library" class="section level2">
<h2>UNIDATA’s udunits library</h2>
<p>Udunits, developed by UCAR/UNIDATA, advertises itself on <a href="https://www.unidata.ucar.edu/software/udunits/">its web page</a> as: “<em>The udunits package supports units of physical quantities. Its C library provides for arithmetic manipulation of units and for conversion of numeric values between compatible units. The package contains an extensive unit database, which is in XML format and user-extendable.</em>”</p>
<p>Unlike the <a href="https://cran.r-project.org/package=measurements">measurements</a> and <a href="https://cran.r-project.org/package=NISTunits">NISTunits</a>, the underlying udunits2 C library parses units as expressions, and bases its logic upon the convertibility of expressions, rather than the comparison of fixed strings:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>m100_a =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&quot;m&quot;</span>, <span class="dv">100</span>), <span class="dt">collapse =</span> <span class="st">&quot;*&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>dm100_b =<span class="st"> &quot;dm^100&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>units<span class="op">::</span><span class="kw">ud_are_convertible</span>(m100_a, dm100_b)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="co">## [1] TRUE</span></span></code></pre></div>
<p>This has the advantage that through complex computations, intermediate objects can have units that are arbitrarily complex, and that can potentially be simplified later on. It also means that the package practically supports an unlimited amount of derived units.</p>
</div>
<div id="udunits-versus-the-unified-code-for-units-of-measure-ucum" class="section level2">
<h2>Udunits versus the Unified Code for Units of Measure (UCUM)</h2>
<p>Another set of encodings for measurement units is the Unified Code for Units of Measure (UCUM, <span class="citation">Schadow and McDonald (<a href="#ref-ucum" role="doc-biblioref">2009</a>)</span>). A dedicated web site describes the details of the differences between udunits and UCUM, and provides a conversion service between the two encoding sets.</p>
<p>The UCUM website refers to some Java implementations, but some of the links seem to be dead. UCUM is the preferred encoding for standards from the Open Geospatial Consortium. udunits on the other hand is the units standard of choice by the climate science community, and is adopted by the CF (Climate and Forecast) conventions, which mostly uses NetCDF. NetCDF <span class="citation">(Rew and Davis <a href="#ref-netcdf" role="doc-biblioref">1990</a>)</span> is a binary data format that is widely used for atmospheric and climate model predictions.</p>
<p>The udunits library is a C library that has strong support from UNIDATA, and we decided to build our developments on this, rather than on Java implementations of UCUM with a less clear provenance.</p>
</div>
<div id="handling-data-with-units-in-r-the-units-package" class="section level2">
<h2>Handling data with units in R: the units package</h2>
<p>The <a href="https://cran.r-project.org/package=units">units</a> package builds <code>units</code> objects from scratch, e.g. where</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">library</span>(units)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="co">## udunits database from /usr/share/xml/udunits/udunits2.xml</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, m<span class="op">/</span>s)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="kw">str</span>(x)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="co">##  Units: [m/s] num [1:5] 1 2 3 4 5</span></span></code></pre></div>
<p>represents speed values in <code>m/s</code>. The units <code>m</code> and <code>s</code> are resolved from the udunits2 C library (but could be user-defined units).</p>
<p>Units can be used in arbitrary R expressions like</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, m<span class="op">/</span>s<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="co">## Units: [m/s^2]</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="co">## [1] 1 2 3</span></span></code></pre></div>
<p>Several manipulations with <code>units</code> objects will now be illustrated. Manipulations that do not involve unit conversion are for instance addition:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, m<span class="op">/</span>s)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>x <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="co">## Units: [m/s]</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="co">## [1] 3 6 9</span></span></code></pre></div>
<p>Explicit unit conversion is done by assigning new units:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>(<span class="dt">x =</span> <span class="kw">set_units</span>(x, cm<span class="op">/</span>s))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="co">## Units: [cm/s]</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="co">## [1] 100 200 300</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a><span class="kw">as.numeric</span>(x)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a><span class="co">## [1] 100 200 300</span></span></code></pre></div>
<p>similar to the behaviour of <code>difftime</code> objects, this modifies the numeric values without modifying their meaning (what the numbers refer to).</p>
<p>When mixing units in sums, comparisons or concatenation, units are automatically converted to those of the first argument:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>y =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, km<span class="op">/</span>h)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>x <span class="op">+</span><span class="st"> </span>y</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a><span class="co">## Units: [cm/s]</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a><span class="co">## [1] 127.7778 255.5556 383.3333</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>y <span class="op">+</span><span class="st"> </span>x</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a><span class="co">## Units: [km/h]</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a><span class="co">## [1]  4.6  9.2 13.8</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a>x <span class="op">==</span><span class="st"> </span>y</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a><span class="co">## [1] FALSE FALSE FALSE</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a><span class="kw">c</span>(y, x)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a><span class="co">## Units: [km/h]</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a><span class="co">## [1]  1.0  2.0  3.0  3.6  7.2 10.8</span></span></code></pre></div>
<p>where <code>c(y, x)</code> concatenates <code>y</code> and <code>x</code> after converting <code>x</code> to the units of <code>y</code>. Derived units are created where appropriate:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>x <span class="op">*</span><span class="st"> </span>y</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a><span class="co">## Units: [cm*km/h/s]</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a><span class="co">## [1] 100 400 900</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>x<span class="op">^</span><span class="dv">3</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a><span class="co">## Units: [cm^3/s^3]</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a><span class="co">## [1] 1.0e+06 8.0e+06 2.7e+07</span></span></code></pre></div>
<p>and meaningful error messages appear when units are not compatible:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>e =<span class="st"> </span><span class="kw">try</span>(z &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>y)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="co">## Error : cannot convert cm*km/h/s into cm/s</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="kw">attr</span>(e, <span class="st">&quot;condition&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a><span class="co">## [1] &quot;cannot convert cm*km/h/s into cm/s&quot;</span></span></code></pre></div>
<p>The full set of methods and method groups for <code>units</code> objects is shown by</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&quot;units&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a><span class="co">##  [1] Math          Ops           Summary       [             [&lt;-          </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a><span class="co">##  [6] [[            [[&lt;-          all.equal     anyDuplicated as.Date      </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a><span class="co">## [11] as.POSIXct    as.data.frame as.list       as_units      boxplot      </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a><span class="co">## [16] c             diff          drop_units    duplicated    format       </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="co">## [21] hist          log10         log2          mean          median       </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a><span class="co">## [26] mixed_units   plot          print         quantile      rep          </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a><span class="co">## [31] seq           set_units     str           summary       unique       </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a><span class="co">## [36] units         units&lt;-       weighted.mean</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a><span class="co">## see &#39;?methods&#39; for accessing help and source code</span></span></code></pre></div>
<p>where the method groups</p>
<ul>
<li><code>Ops</code> include operations that require compatible units, converting when necessary (<code>+</code>, <code>-</code>, <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>), and operations that create new units (<code>*</code>, <code>/</code>, <code>^</code> and <code>**</code>),</li>
<li><code>Math</code> include <code>abs</code>, <code>sign</code>, <code>floor</code>, <code>ceiling</code>, <code>trunc</code>, <code>round</code>, <code>signif</code>, <code>log</code>, <code>cumsum</code>, <code>cummax</code>, <code>cummin</code>, and</li>
<li><code>Summary</code> include <code>sum</code>, <code>min</code>, <code>max</code> and <code>range</code>, and all convert to the unit of the first argument.</li>
</ul>
<p>When possible, new units are simplified:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>a =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, m<span class="op">/</span>s)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>b =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, h)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>a <span class="op">*</span><span class="st"> </span>b</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a><span class="co">## Units: [m]</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a><span class="co">##  [1]   3600  14400  32400  57600  90000 129600 176400 230400 291600 360000</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>ustr1 =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&quot;m&quot;</span>, <span class="dv">101</span>), <span class="dt">collapse =</span> <span class="st">&quot;*&quot;</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>ustr2 =<span class="st"> &quot;dm^100&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a><span class="kw">as_units</span>(ustr1) <span class="op">/</span><span class="st"> </span><span class="kw">as_units</span>(ustr2)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a><span class="co">## 1e+100 [m]</span></span></code></pre></div>
<p>Units are printed as simple R expressions, e.g.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="kw">set_units</span>(<span class="dv">1</span>, m<span class="op">^</span><span class="dv">5</span><span class="op">/</span>s<span class="op">^</span><span class="dv">4</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="co">## 1 [m^5/s^4]</span></span></code></pre></div>
<p>Another way to print units commonly seen in Climate and Forecast Conventions is <code>m2 s-1</code> for m<span class="math inline">\(^2\)</span>/s. These are not R expressions, but they can be parsed by <code>as_units</code>, and created by <code>deparse_unit</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="kw">as_units</span>(<span class="st">&quot;m2 s-1&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="co">## 1 [m^2/s]</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a><span class="kw">deparse_unit</span>(<span class="kw">set_units</span>(<span class="dv">1</span>, m<span class="op">^</span><span class="dv">2</span><span class="op">*</span>s<span class="op">^-</span><span class="dv">1</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a><span class="co">## [1] &quot;m2 s-1&quot;</span></span></code></pre></div>
<p>The <code>plot</code> and <code>hist</code> methods add units to default axis labels, an example is shown in the following figures. For <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a> plots <span class="citation">(Wickham <a href="#ref-ggplot2" role="doc-biblioref">2009</a>)</span>, automatic unit placement in default axis label is also provided; <code>demo(ggplot2)</code> gives an example.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="kw">library</span>(units)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="kw">units_options</span>(<span class="dt">negative_power =</span> <span class="ot">TRUE</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a><span class="co"># initialize variables with units:</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>mtcars<span class="op">$</span>consumption =<span class="st"> </span><span class="kw">set_units</span>(mtcars<span class="op">$</span>mpg, mi<span class="op">/</span>gallon)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="co"># &quot;in&quot; is also a reserved R keyword, and so needs back-quotes:</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>mtcars<span class="op">$</span>displacement =<span class="st"> </span><span class="kw">set_units</span>(mtcars<span class="op">$</span>disp, <span class="st">`</span><span class="dt">in</span><span class="st">`</span><span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a><span class="co"># convert to SI:</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a>mtcars<span class="op">$</span>consumption =<span class="st"> </span><span class="kw">set_units</span>(mtcars<span class="op">$</span>consumption, km<span class="op">/</span>l)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>mtcars<span class="op">$</span>displacement =<span class="st"> </span><span class="kw">set_units</span>(mtcars<span class="op">$</span>displacement, cm<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">par</span>(<span class="st">&quot;mar&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.3</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a><span class="kw">with</span>(mtcars, <span class="kw">plot</span>(<span class="dv">1</span><span class="op">/</span>displacement, <span class="dv">1</span><span class="op">/</span>consumption))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">/</span>displacement, <span class="dt">y =</span> <span class="dv">1</span><span class="op">/</span>consumption))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Automatic conversion between <code>units</code> and <code>difftime</code> is provided:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>(<span class="dt">dt =</span> <span class="kw">diff</span>(<span class="kw">Sys.time</span>() <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>, <span class="dv">1</span><span class="op">+</span><span class="dv">60</span><span class="op">+</span><span class="dv">3600</span>))) <span class="co"># class difftime</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="co">## Time differences in secs</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a><span class="co">## [1]    1   60 3600</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>(<span class="dt">dt.u =</span> <span class="kw">as_units</span>(dt))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a><span class="co">## Units: [s]</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a><span class="co">## [1]    1   60 3600</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a><span class="kw">identical</span>(<span class="kw">as_difftime</span>(dt.u), dt)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true"></a><span class="co">## [1] TRUE</span></span></code></pre></div>
<p>as well as to and from <code>POSIXct</code> or <code>Date</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>(t1 &lt;-<span class="st"> </span><span class="kw">as_units</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;2017-08-20 17:03:00&quot;</span>)))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="co">## 1503248580 [(seconds since 1970-01-01 00:00:00 +00:00)]</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>(t2 &lt;-<span class="st"> </span><span class="kw">as_units</span>(<span class="kw">as.POSIXct</span>(<span class="st">&quot;2017-08-20 17:03:00&quot;</span>), <span class="st">&quot;hours since 2017-08-20&quot;</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a><span class="co">## 17.05 [(hours since 2017-08-20)]</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a>(d1 &lt;-<span class="st"> </span><span class="kw">as_units</span>(<span class="kw">as.Date</span>(<span class="st">&quot;2017-08-20&quot;</span>)))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a><span class="co">## 17398 [(days since 1970-01-01)]</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a><span class="kw">as.POSIXct</span>(t1)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a><span class="co">## [1] &quot;2017-08-20 17:03:00 UTC&quot;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a><span class="kw">as.Date</span>(d1)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a><span class="co">## [1] &quot;2017-08-20&quot;</span></span></code></pre></div>
<p>Objects of class <code>units</code> can be used as columns in <code>data.frame</code> objects, as well as in <code>tbl_df</code> <span class="citation">(Wickham, Francois, and Müller <a href="#ref-tibble" role="doc-biblioref">2016</a>)</span>. They can also be <code>matrix</code> or <code>array</code>, with the constraint that a single unit holds for all elements.</p>
</div>
<div id="discussion-and-conclusions" class="section level2">
<h2>Discussion and conclusions</h2>
<p>The <a href="https://cran.r-project.org/package=units">units</a> R package provides a new class, <code>units</code>, for numeric data with associated measurement units. Operations on objects of this class retain the unit metadata and provide automated dimensional analysis: dimensions are taken into consideration in computations and comparisons. Combining different units that are compatible triggers automatic unit conversion, derived units are automatically generated and simplified where possible, and meaningful error messages are given when a user tries to add objects with incompatible units. This verifies that computations are not only syntactically and numerically allowed, but also semantically, and in the case of physical units, physically allowed, which may support code verification and provenance tracking. Using this package may eliminate a whole class of potential scientific programming mistakes.</p>
<p>Where the R packages <a href="https://cran.r-project.org/package=measurements">measurements</a> and <a href="https://cran.r-project.org/package=NISTunits">NISTunits</a> provide conversion between a fixed number of units, with the help of the udunits2 C library and unit database, R package <a href="https://cran.r-project.org/package=units">units</a> handles arbitrarily complex derived units. By treating units as expressions it can derive, convert and simplify units. In addition, beyond the SI units packaged, <a href="https://cran.r-project.org/package=units">units</a> handles user-defined units.</p>
<p>Data in <code>units</code> vectors can be stored as columns in <code>data.frame</code> or <code>tbl_df</code> objects, and can be converted to and from <code>difftime</code>. When <code>units</code> objects have associated time and location information, they could be stored in spatial or spatio-temporal objects provided by <a href="https://cran.r-project.org/package=sp">sp</a> or <a href="https://cran.r-project.org/package=spacetime">spacetime</a> <span class="citation">(Pebesma <a href="#ref-spacetime" role="doc-biblioref">2012</a>)</span> as these store attribute data in <code>data.frame</code> slots, but for instance not in <code>zoo</code> <span class="citation">(Zeileis and Grothendieck <a href="#ref-zoo" role="doc-biblioref">2005</a>)</span> or <code>xts</code> <span class="citation">(Ryan and Ulrich <a href="#ref-xts" role="doc-biblioref">2014</a>)</span> objects, as these latter two set the class attribute of a vector or matrix.</p>
<p>Despite all standardization efforts, units may still be ambiguous, or subject to interpretation. For instance for the duration of one year <a href="https://cran.r-project.org/package=NISTunits">NISTunits</a> gives us an answer that depends on whether we want a common, leap, Gregorian, Julian, tropical or siderial year (<span class="citation">Lang (<a href="#ref-lang" role="doc-biblioref">2006</a>)</span>, see also <code>demo(year)</code>). This illustrates that those who apply unit conversion should be aware of possible pitfalls. Support for calendars in udunits seems not as well developed as in R.</p>
<p>Future work includes extending packages that read external data from formats, databases or interfaces with support for measurement unit information into R, preserving the measurement unit information. Examples would be interfaces to HDF5 (e.g., <a href="https://cran.r-project.org/package=h5">h5</a>, <span class="citation">Annau (<a href="#ref-h5" role="doc-biblioref">2016</a>)</span>), <a href="https://cran.r-project.org/package=RNetCDF">RNetCDF</a> <span class="citation">(Michna and Woods <a href="#ref-RNetCDF" role="doc-biblioref">2016</a>)</span> or <a href="https://cran.r-project.org/package=sos4R">sos4R</a> <span class="citation">(Nüst, Stasch, and Pebesma <a href="#ref-sos4R" role="doc-biblioref">2011</a>)</span>. It would be nice to see units of measurements propagate into units of regression coefficient estimates.</p>
</div>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>We acknowledge three anonymous reviewers and the handling editor for their constructive comments, and Thomas Lin Pedersen for implementing the ggplot extensions in package <code>ggforce</code> (ported to the <code>units</code> package since v0.8-0) that automatically add units to default ggplot axis labels.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-h5">
<p>Annau, Mario. 2016. <em>H5: Interface to the ’Hdf5’ Library</em>. <a href="https://CRAN.R-project.org/package=h5">https://CRAN.R-project.org/package=h5</a>.</p>
</div>
<div id="ref-measurements">
<p>Birk, Matthew A. 2016. <em>Measurements: Tools for Units of Measurement</em>. <a href="https://CRAN.R-project.org/package=measurements">https://CRAN.R-project.org/package=measurements</a>.</p>
</div>
<div id="ref-cobb">
<p>Cobb, George W., and David S. Moore. 1997. “Mathematics, Statistics, and Teaching.” <em>American Mathematical Monthly</em>, 801–23.</p>
</div>
<div id="ref-NISTunits">
<p>Gama, Jose. 2014. <em>NISTunits: Fundamental Physical Constants and Unit Conversions from Nist</em>. <a href="https://CRAN.R-project.org/package=NISTunits">https://CRAN.R-project.org/package=NISTunits</a>.</p>
</div>
<div id="ref-lubridate">
<p>Grolemund, Garrett, and Hadley Wickham. 2011. “Dates and Times Made Easy with Lubridate.” <em>Journal of Statistical Software</em> 40 (1): 1–25. <a href="https://doi.org/10.18637/jss.v040.i03">https://doi.org/10.18637/jss.v040.i03</a>.</p>
</div>
<div id="ref-iliffe">
<p>Iliffe, Jonathan, and Roger Lott. 2008. <em>Datums and Map Projections: For Remote Sensing, Gis and Surveying</em>. CRC Inc.</p>
</div>
<div id="ref-si">
<p>International Bureau of Weights and Measures, Barry N Taylor, and Ambler Thompson. 2001. “The International System of Units (SI).”</p>
</div>
<div id="ref-lang">
<p>Lang, K. R. 2006. <em>Astrophysical Formulae Volume Ii: Space, Time, Matter and Cosmology, 3rd Edition 1999. 2nd Printing</em>. Springer.</p>
</div>
<div id="ref-RNetCDF">
<p>Michna, Pavel, and Milton Woods. 2016. <em>RNetCDF: Interface to Netcdf Datasets</em>. <a href="https://CRAN.R-project.org/package=RNetCDF">https://CRAN.R-project.org/package=RNetCDF</a>.</p>
</div>
<div id="ref-sos4R">
<p>Nüst, D., C. Stasch, and E. J. Pebesma. 2011. “Advancing Geoinformation Science for a Changing World.” In, edited by S. Geertman, W. Reinhardt, and F. Toppen, 227–46. Lecture Notes in Geoinformation and Cartography. Springer.</p>
</div>
<div id="ref-spacetime">
<p>Pebesma, Edzer. 2012. “Spacetime: Spatio-Temporal Data in R.” <em>Journal of Statistical Software</em> 51 (1): 1–30. <a href="https://doi.org/10.18637/jss.v051.i07">https://doi.org/10.18637/jss.v051.i07</a>.</p>
</div>
<div id="ref-sp">
<p>Pebesma, Edzer, and Roger Bivand. 2005. “Classes and Methods for Spatial Data in R.” <em>R News</em> 5 (2): 9–13. <a href="https://cran.r-project.org/doc/Rnews/">https://cran.r-project.org/doc/Rnews/</a>.</p>
</div>
<div id="ref-rj">
<p>Pebesma, Edzer, Thomas Mailund, and James Hiebert. 2016. “Measurement Units in R.” <em>The R Journal</em> 8 (2): 486–94. <a href="https://doi.org/10.32614/RJ-2016-061">https://doi.org/10.32614/RJ-2016-061</a>.</p>
</div>
<div id="ref-netcdf">
<p>Rew, Russ, and Glenn Davis. 1990. “NetCDF: An Interface for Scientific Data Access.” <em>IEEE Computer Graphics and Applications</em> 10 (4): 76–82.</p>
</div>
<div id="ref-xts">
<p>Ryan, Jeffrey A., and Joshua M. Ulrich. 2014. <em>Xts: EXtensible Time Series</em>. <a href="https://CRAN.R-project.org/package=xts">https://CRAN.R-project.org/package=xts</a>.</p>
</div>
<div id="ref-ucum">
<p>Schadow, Gunther, and Clement J McDonald. 2009. “The Unified Code for Units of Measure.” <em>Regenstrief Institute and UCUM Organization: Indianapolis, IN, USA</em>.</p>
</div>
<div id="ref-scheider">
<p>Scheider, Simon, Benedikt Gräler, Edzer Pebesma, and Christoph Stasch. 2016. “Modeling Spatiotemporal Information Generation.” <em>International Journal of Geographical Information Science</em> 30 (10): 1980–2008. <a href="https://dx.doi.org/10.1080/13658816.2016.1151520">https://dx.doi.org/10.1080/13658816.2016.1151520</a>.</p>
</div>
<div id="ref-ggplot2">
<p>Wickham, Hadley. 2009. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York.</p>
</div>
<div id="ref-tibble">
<p>Wickham, Hadley, Romain Francois, and Kirill Müller. 2016. <em>Tibble: Simple Data Frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>.</p>
</div>
<div id="ref-zoo">
<p>Zeileis, Achim, and Gabor Grothendieck. 2005. “Zoo: S3 Infrastructure for Regular and Irregular Time Series.” <em>Journal of Statistical Software</em> 14 (6): 1–27. <a href="https://doi.org/10.18637/jss.v014.i06">https://doi.org/10.18637/jss.v014.i06</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
